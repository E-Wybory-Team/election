@page "/modifydistrict/{districtId:int}"
@using System.ComponentModel.DataAnnotations
@inject NavigationManager NavigationManager
<link href="forms.css" rel="stylesheet" />

<div class="form-container">
    <h1>MODYFIKOWANIE OBWODU WYBORCZEGO</h1>
    <EditForm Model="@districtModel" OnValidSubmit="HandleSubmit">
        <DataAnnotationsValidator />
        <ValidationSummary />

        <div class="form-group-smaller">
            <label for="districtNumber">NR OBWODU</label>
            <InputText @bind-Value="districtModel.DistrictNumber" id="districtNumber" placeholder="Nr obwodu wyborczego" />
        </div>

        <div class="form-group-smaller">
            <label for="seat">SIEDZIBA</label>
            <InputText @bind-Value="districtModel.Seat" id="seat" placeholder="Siedziba obwodu" />
        </div>

        <div class="form-group-smaller">
            <label for="accessibility">DOSTĘPNOŚĆ</label>
            <InputSelect @bind-Value="districtModel.Accessibility" id="accessibility">
                <option value="tak">Tak</option>
                <option value="nie">Nie</option>
            </InputSelect>
        </div>

        <div class="form-group-smaller">
            <label for="voivodeship">WOJEWÓDZTWO</label>
            <InputSelect @bind-Value="districtModel.Voivodeship" id="voivodeship">
                @foreach (var voivodeship in voivodeships)
                {
                    <option value="@voivodeship">@voivodeship</option>
                }
            </InputSelect>
        </div>

        <div class="form-group-smaller">
            <label for="county">POWIAT</label>
            <InputSelect @bind-Value="districtModel.County" id="county">
                @foreach (var county in counties)
                {
                    <option value="@county">@county</option>
                }
            </InputSelect>
        </div>

        <div class="form-group-smaller">
            <label for="province">GMINA</label>
            <InputSelect @bind-Value="districtModel.Province" id="province">
                @foreach (var province in provinces)
                {
                    <option value="@province">@province</option>
                }
            </InputSelect>
        </div>

        <div class="form-row">
            <button type="submit" class="submit-button">ZATWIERDŹ ZMIANY</button>
            <a href="/PKWHome" class="add-button">ANULUJ</a>
        </div>
    </EditForm>
</div>

@code {
    [Parameter]
    public int districtId { get; set; }

    private DistrictModel districtModel = new DistrictModel();
    private List<string> voivodeships = new() { "Opolskie", "Śląskie", "Małopolskie" };
    private List<string> counties = new() { "Powiat 1", "Powiat 2", "Powiat 3" };
    private List<string> provinces = new() { "Gmina 1", "Gmina 2", "Gmina 3" };

    protected override void OnInitialized()
    {
        var district = GetDistrictById(districtId);
        if (district != null)
        {
            districtModel = new DistrictModel
                {
                    DistrictNumber = district.DistrictNumber,
                    Seat = district.Seat,
                    Accessibility = district.Accessibility,
                    Voivodeship = district.Voivodeship,
                    County = district.County,
                    Province = district.Province
                };
        }
    }

    private District? GetDistrictById(int id)
    {
        var districts = new List<District>
        {
            new District { Id = 1, DistrictNumber = "1", Seat = "Szkoła Podstawowa, ul. Szkolna 5", Accessibility = "tak", Voivodeship = "Opolskie", County = "Kędzierzyńsko-Kozielski", Province = "Kędzierzyn-Koźle" },
            new District { Id = 2, DistrictNumber = "2", Seat = "Szkoła Podstawowa, ul. Kościelna 1", Accessibility = "nie", Voivodeship = "Opolskie", County = "Kędzierzyńsko-Kozielski", Province = "Bierawa" }
        };
        return districts.FirstOrDefault(d => d.Id == id);
    }

    private void HandleSubmit()
    {
        Console.WriteLine($"Zmodyfikowano obwód: {districtModel.DistrictNumber}");
        NavigationManager.NavigateTo("/districtlist");
    }

    private void Cancel()
    {
        NavigationManager.NavigateTo("/districtlist");
    }

    public class DistrictModel
    {
        public string DistrictNumber { get; set; }
        public string Seat { get; set; }
        public string Accessibility { get; set; }
        public string Voivodeship { get; set; }
        public string County { get; set; }
        public string Province { get; set; }
    }

    public class District
    {
        public int Id { get; set; }
        public string DistrictNumber { get; set; }
        public string Seat { get; set; }
        public string Accessibility { get; set; }
        public string Voivodeship { get; set; }
        public string County { get; set; }
        public string Province { get; set; }
    }
}
